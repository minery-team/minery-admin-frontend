(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[778],{1768:function(e,t,a){Promise.resolve().then(a.bind(a,77029))},77029:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var n=a(57437),r=a(66287),s=a(59077),o=a(73685);async function i(){let e=await o.L.get("/order/all");return e.data}async function d(e,t){o.L.post("/order/".concat(e,"/start-delivery"),{waybillNumber:t})}async function l(e,t){o.L.post("/order/".concat(e,"/status"),{status:t})}var c=a(86185),u=a(68710),h=a(88110),m=a.n(h),p=a(68939),f=a(91016);let v={PAYMENT:"주문완료",PREPARE:"준비중",SEND:"배송시작",DONE:"배송 완료",CANCEL:"주문 반려"};var y=(0,f.Z)(()=>{let{data:e,isLoading:t,handleStatusChange:a,handleSentClick:o}=function(){var e;let t=(0,s.useQuery)(["order-list"],()=>i()),a=null===(e=t.data)||void 0===e?void 0:e.map((e,t)=>({key:t,id:e.id,phone:e.address.phone,payDate:(0,c.Z)(new Date(e.payment.time),"yy년 MM월 dd일"),cancleDate:"FIXME",price:e.cost,payment:e.status,additionalInfo:{address:e.address.address,deliveryMessage:e.deliveryMessage,orderInfo:e.items,tossOrderId:e.payment.orderId,waybillNumber:e.waybillNumber}}));return{data:a,isLoading:t.isLoading,handleStatusChange:e=>{let{status:t,id:a}=e;l(a,t)},handleSentClick:e=>{let t=Number(prompt("운송장 번호를 입력해주세요"));t&&(d(e,t),l(e,"SENT").then(()=>{alert("배송중으로 상태가 변경되지 않을텐데.. 새로고침 부탁드리겠습니다!(반영예정)")}))}}}(),h=[{title:"주문번호",dataIndex:"id",key:"id"},{title:"주문자 핸드폰 번호",dataIndex:"phone",key:"phone"},{title:"결제일시",dataIndex:"payDate",key:"payDate"},{title:"취소일시",dataIndex:"cancleDate",key:"cancleDate"},{title:"주문금액",dataIndex:"price",key:"price"},{title:"결제상태",key:"payment",render:(e,t)=>(0,n.jsx)(r.Z,{wrap:!0,children:(0,n.jsx)(u.Z,{defaultValue:v[t.payment]||"배송중",style:{width:120},onChange:e=>a({status:e,id:t.id}),options:[{value:"PAYMENT",label:"주문완료"},{value:"PREPARE",label:"준비중"},{value:"DONE",label:"배송 완료"},{value:"CANCEL",label:"주문 반려"}]})})},{title:"배송 시작",dataIndex:"delivery",key:"delivery",render:(e,t)=>(0,n.jsx)(m(),{onClick:()=>{o(t.id)},children:"배송 시작"})}];return t?(0,n.jsx)(n.Fragment,{children:"로딩 중.."}):(0,n.jsx)("div",{className:"h-screen overflow-auto",children:(0,n.jsx)(p.Z,{columns:h,dataSource:e,expandable:{expandedRowRender:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["배송지: ",e.additionalInfo.address]}),(0,n.jsxs)("p",{children:["배송 요청사항: ",e.additionalInfo.deliveryMessage]}),(0,n.jsxs)("div",{children:["구매상품(",e.additionalInfo.orderInfo.length,"):",e.additionalInfo.orderInfo.map(e=>(0,n.jsxs)("p",{children:[" - ",e.product.name]},e.id))]}),(0,n.jsxs)("p",{children:["토스 주문번호: ",e.additionalInfo.tossOrderId]}),(0,n.jsxs)("p",{children:["송장번호: ",e.additionalInfo.waybillNumber]})]})}})})})},73685:function(e,t,a){"use strict";a.d(t,{L:function(){return i}});var n=a(29222),r=a(82170),s=a(92164);async function o(e){let t=(0,r.hP)();return{...e,headers:new s.uu({...e.headers.toJSON(),Authorization:"Bearer ".concat(t)})}}let i=n.default.create({baseURL:"https://r0up0kec01.execute-api.ap-northeast-2.amazonaws.com/live"});i.interceptors.request.use(o)},91016:function(e,t,a){"use strict";var n=a(57437),r=a(24033),s=a(2265),o=a(82170);t.Z=e=>t=>{let a=(0,r.useRouter)(),i=(0,o.hP)(),d=(0,r.usePathname)();return(0,s.useEffect)(()=>{i||"/login"===d||a.push("/login?from=".concat(d))},[i]),(0,n.jsx)(e,{...t})}},82170:function(e,t,a){"use strict";a.d(t,{hP:function(){return d},M8:function(){return l}});class n{get(e){return this.storage.get(e)}set(e,t){this.storage.set(e,t)}remove(e){this.storage.delete(e)}constructor(){this.storage=new Map}}class r{static canUse(){let e="LOCAL_STORAGE_TEST_KEY";try{return localStorage.setItem(e,"test"),localStorage.removeItem(e),!0}catch(e){return!1}}get(e){var t;return null!==(t=localStorage.getItem(e))&&void 0!==t?t:void 0}set(e,t){localStorage.setItem(e,t)}remove(e){localStorage.removeItem(e)}}class s{static canUse(){let e="SESSION_STORAGE_TEST_KEY";try{return sessionStorage.setItem(e,"test"),sessionStorage.removeItem(e),!0}catch(e){return!1}}get(e){var t;return null!==(t=sessionStorage.getItem(e))&&void 0!==t?t:void 0}set(e,t){sessionStorage.setItem(e,t)}remove(e){sessionStorage.removeItem(e)}}r.canUse()?new r:new n;let o=s.canUse()?new s:new n,i="@YWNjZXNzX3Rva2Vu";function d(){return o.get(i)}function l(e){return o.set(i,e)}}},function(e){e.O(0,[89,77,113,110,677,340,821,873,971,596,744],function(){return e(e.s=1768)}),_N_E=e.O()}]);